<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Export/Import Excel avec Backup Jours Pos√©s</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        button { padding: 10px 20px; margin: 5px; border-radius: 5px; border: none; background: #007bff; color: white; cursor: pointer; }
        button:hover { background: #0056b3; }
        .data-display { background: #f8f9fa; padding: 10px; border-radius: 5px; margin: 10px 0; font-family: monospace; }
    </style>
</head>
<body>
    <h1>üß™ Test Export/Import Excel avec Backup des Jours Pos√©s</h1>
    
    <div class="test-section info">
        <h2>üìã Fonctionnalit√©s test√©es</h2>
        <ul>
            <li><strong>Export Excel Ann√©e</strong> : Cr√©e un fichier avec une feuille par mois + feuille de backup</li>
            <li><strong>Export Excel Mois</strong> : Cr√©e un fichier avec une feuille du mois + feuille de backup</li>
            <li><strong>Feuille de Backup</strong> : Contient tous les jours pos√©s (CP, RTT, RHT, F√©ri√©s, Rattrap√©s)</li>
            <li><strong>Import Excel</strong> : R√©cup√®re les horaires ET les jours pos√©s depuis le backup</li>
            <li><strong>Nommage intelligent</strong> : Feuilles avec "-RHT" si RHT actif dans le mois</li>
        </ul>
    </div>
    
    <div class="test-section">
        <h2>üîß Configuration des donn√©es de test</h2>
        <p>Avant de tester, configurez quelques jours pos√©s dans le modal de vacances :</p>
        <ol>
            <li>Ouvrez le modal de vacances (bouton "Vacances")</li>
            <li>Posez quelques cong√©s pay√©s, RTT, RHT, f√©ri√©s ou jours rattrap√©s</li>
            <li>Saisissez quelques horaires sur certains jours</li>
            <li>Testez ensuite les exports</li>
        </ol>
    </div>
    
    <div class="test-section">
        <h2>üì§ Test des Exports</h2>
        <button onclick="testExportAnnee()">Export Excel Ann√©e</button>
        <button onclick="testExportMois()">Export Excel Mois</button>
        <p><em>V√©rifiez que les fichiers Excel contiennent bien :</em></p>
        <ul>
            <li>Une feuille par mois (avec "-RHT" si applicable)</li>
            <li>Une feuille "Backup_Jours_Pos√©s" avec tous les jours pos√©s</li>
        </ul>
    </div>
    
    <div class="test-section">
        <h2>üì• Test de l'Import</h2>
        <p><em>Pour tester l'import :</em></p>
        <ol>
            <li>Supprimez quelques jours pos√©s dans le modal de vacances</li>
            <li>Importez le fichier Excel export√© pr√©c√©demment</li>
            <li>V√©rifiez que les jours pos√©s sont restaur√©s</li>
        </ol>
        <button onclick="testImport()">Importer un fichier Excel</button>
        <input type="file" id="import-test" accept=".xlsx, .xls" style="display:none;">
    </div>
    
    <div class="test-section">
        <h2>üìä √âtat actuel des donn√©es</h2>
        <div class="data-display" id="current-data">
            Chargement des donn√©es...
        </div>
        <button onclick="refreshData()">Actualiser</button>
    </div>
    
    <div class="test-section success">
        <h2>‚úÖ Points de v√©rification</h2>
        <ul>
            <li><strong>Export</strong> : Les feuilles sont-elles nomm√©es correctement ?</li>
            <li><strong>Backup</strong> : La feuille "Backup_Jours_Pos√©s" contient-elle tous les types de jours ?</li>
            <li><strong>Import</strong> : Les jours pos√©s sont-ils restaur√©s apr√®s suppression + import ?</li>
            <li><strong>RHT</strong> : Les calculs d'√©cart sont-ils mis √† jour selon les param√®tres RHT ?</li>
        </ul>
    </div>

    <script>
        // Fonction pour actualiser l'affichage des donn√©es
        function refreshData() {
            const joursVacances = JSON.parse(localStorage.getItem('joursVacances')) || [];
            const joursRTT = JSON.parse(localStorage.getItem('joursRTT')) || [];
            const joursRHT = JSON.parse(localStorage.getItem('joursRHT')) || [];
            const joursFeries = JSON.parse(localStorage.getItem('joursFeries')) || [];
            const joursRattrapes = JSON.parse(localStorage.getItem('joursRattrapes')) || [];
            const jours = JSON.parse(localStorage.getItem('jours')) || [];
            
            const dataDisplay = document.getElementById('current-data');
            dataDisplay.innerHTML = `
                <strong>Jours pos√©s :</strong><br>
                ‚Ä¢ Cong√©s pay√©s : ${joursVacances.length} jour(s)<br>
                ‚Ä¢ RTT : ${joursRTT.length} jour(s)<br>
                ‚Ä¢ RHT : ${joursRHT.length} jour(s)<br>
                ‚Ä¢ F√©ri√©s : ${joursFeries.length} jour(s)<br>
                ‚Ä¢ Rattrap√©s : ${joursRattrapes.length} jour(s)<br><br>
                <strong>Jours avec horaires :</strong> ${jours.length} jour(s)<br>
                <strong>Derni√®re mise √† jour :</strong> ${new Date().toLocaleString()}
            `;
        }
        
        // Test de l'export ann√©e
        function testExportAnnee() {
            alert('Cliquez sur "Export Excel ann√©e" dans l\'application principale pour tester');
        }
        
        // Test de l'export mois
        function testExportMois() {
            alert('Cliquez sur "Export Excel mois" dans l\'application principale pour tester');
        }
        
        // Test de l'import
        function testImport() {
            document.getElementById('import-test').click();
        }
        
        // Gestion de l'import de test
        document.getElementById('import-test').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                alert(`Fichier s√©lectionn√© : ${file.name}\n\nPour tester l'import complet, utilisez le bouton "Importer un fichier Excel" dans l'application principale.`);
            }
        });
        
        // Actualiser les donn√©es au chargement
        document.addEventListener('DOMContentLoaded', refreshData);
    </script>
</body>
</html>
