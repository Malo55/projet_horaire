<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Suppression Ann√©e avec Jours Pos√©s</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .warning { background-color: #fff3cd; border-color: #ffeaa7; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        button { padding: 10px 20px; margin: 5px; border-radius: 5px; border: none; background: #dc3545; color: white; cursor: pointer; }
        button:hover { background: #c82333; }
        .data-display { background: #f8f9fa; padding: 10px; border-radius: 5px; margin: 10px 0; font-family: monospace; }
        .danger-zone { background: #f8d7da; border: 2px solid #dc3545; padding: 15px; border-radius: 8px; }
    </style>
</head>
<body>
    <h1>üß™ Test Suppression Ann√©e avec Jours Pos√©s</h1>
    
    <div class="test-section info">
        <h2>üìã Fonctionnalit√© test√©e</h2>
        <p>Le bouton <strong>"Supprimer toutes les entr√©es de l'ann√©e affich√©e"</strong> doit maintenant :</p>
        <ul>
            <li>‚úÖ Supprimer tous les horaires saisis de l'ann√©e</li>
            <li>‚úÖ Supprimer tous les cong√©s pay√©s de l'ann√©e</li>
            <li>‚úÖ Supprimer tous les RTT de l'ann√©e</li>
            <li>‚úÖ Supprimer tous les RHT de l'ann√©e</li>
            <li>‚úÖ Supprimer tous les jours f√©ri√©s de l'ann√©e</li>
            <li>‚úÖ Supprimer tous les jours rattrap√©s de l'ann√©e</li>
        </ul>
    </div>
    
    <div class="test-section warning">
        <h2>‚ö†Ô∏è Attention</h2>
        <p>Cette action est <strong>irr√©versible</strong> et supprimera d√©finitivement toutes les donn√©es de l'ann√©e affich√©e.</p>
        <p>Assurez-vous d'avoir fait un export Excel avant de tester !</p>
    </div>
    
    <div class="test-section">
        <h2>üîß Pr√©paration du test</h2>
        <ol>
            <li>Configurez quelques jours pos√©s dans le modal de vacances</li>
            <li>Saisissez quelques horaires sur certains jours</li>
            <li>Notez le nombre de jours pos√©s et d'horaires avant le test</li>
            <li>Testez la suppression de l'ann√©e</li>
            <li>V√©rifiez que tout a √©t√© supprim√©</li>
        </ol>
    </div>
    
    <div class="test-section">
        <h2>üìä √âtat actuel des donn√©es</h2>
        <div class="data-display" id="current-data">
            Chargement des donn√©es...
        </div>
        <button onclick="refreshData()">Actualiser</button>
    </div>
    
    <div class="danger-zone">
        <h2>üóëÔ∏è Test de Suppression</h2>
        <p><strong>√âTAPE 1 :</strong> V√©rifiez les donn√©es ci-dessus</p>
        <p><strong>√âTAPE 2 :</strong> Cliquez sur "Supprimer toutes les entr√©es de l'ann√©e affich√©e" dans l'application principale</p>
        <p><strong>√âTAPE 3 :</strong> Confirmez la suppression</p>
        <p><strong>√âTAPE 4 :</strong> Actualisez les donn√©es ci-dessous pour v√©rifier</p>
        
        <button onclick="refreshData()">Actualiser apr√®s suppression</button>
    </div>
    
    <div class="test-section success">
        <h2>‚úÖ V√©rification</h2>
        <p>Apr√®s la suppression, v√©rifiez que :</p>
        <ul>
            <li>Le nombre de jours avec horaires est revenu √† 0</li>
            <li>Le nombre de cong√©s pay√©s est revenu √† 0</li>
            <li>Le nombre de RTT est revenu √† 0</li>
            <li>Le nombre de RHT est revenu √† 0</li>
            <li>Le nombre de jours f√©ri√©s est revenu √† 0</li>
            <li>Le nombre de jours rattrap√©s est revenu √† 0</li>
        </ul>
        <p><em>Note : Si vous avez des jours pos√©s sur d'autres ann√©es, ils ne doivent pas √™tre affect√©s.</em></p>
    </div>
    
    <div class="test-section">
        <h2>üîÑ Restauration</h2>
        <p>Pour restaurer vos donn√©es apr√®s le test :</p>
        <ol>
            <li>Utilisez le bouton "Importer un fichier Excel"</li>
            <li>S√©lectionnez le fichier Excel export√© avant le test</li>
            <li>V√©rifiez que toutes les donn√©es sont restaur√©es</li>
        </ol>
    </div>

    <script>
        // Fonction pour actualiser l'affichage des donn√©es
        function refreshData() {
            const joursVacances = JSON.parse(localStorage.getItem('joursVacances')) || [];
            const joursRTT = JSON.parse(localStorage.getItem('joursRTT')) || [];
            const joursRHT = JSON.parse(localStorage.getItem('joursRHT')) || [];
            const joursFeries = JSON.parse(localStorage.getItem('joursFeries')) || [];
            const joursRattrapes = JSON.parse(localStorage.getItem('joursRattrapes')) || [];
            const jours = JSON.parse(localStorage.getItem('jours')) || [];
            
            // Compter les jours de l'ann√©e courante
            const currentYear = new Date().getFullYear();
            const anneeStr = String(currentYear);
            
            const joursAnnee = jours.filter(jour => jour.date.startsWith(anneeStr + '-'));
            const vacancesAnnee = joursVacances.filter(dateStr => dateStr.startsWith(anneeStr + '-'));
            const rttAnnee = joursRTT.filter(dateStr => dateStr.startsWith(anneeStr + '-'));
            const rhtAnnee = joursRHT.filter(dateStr => dateStr.startsWith(anneeStr + '-'));
            const feriesAnnee = joursFeries.filter(dateStr => dateStr.startsWith(anneeStr + '-'));
            const rattrapesAnnee = joursRattrapes.filter(dateStr => dateStr.startsWith(anneeStr + '-'));
            
            const dataDisplay = document.getElementById('current-data');
            dataDisplay.innerHTML = `
                <strong>Ann√©e ${currentYear} :</strong><br>
                ‚Ä¢ Jours avec horaires : ${joursAnnee.length} jour(s)<br>
                ‚Ä¢ Cong√©s pay√©s : ${vacancesAnnee.length} jour(s)<br>
                ‚Ä¢ RTT : ${rttAnnee.length} jour(s)<br>
                ‚Ä¢ RHT : ${rhtAnnee.length} jour(s)<br>
                ‚Ä¢ F√©ri√©s : ${feriesAnnee.length} jour(s)<br>
                ‚Ä¢ Rattrap√©s : ${rattrapesAnnee.length} jour(s)<br><br>
                <strong>Total toutes ann√©es :</strong><br>
                ‚Ä¢ Jours avec horaires : ${jours.length} jour(s)<br>
                ‚Ä¢ Cong√©s pay√©s : ${joursVacances.length} jour(s)<br>
                ‚Ä¢ RTT : ${joursRTT.length} jour(s)<br>
                ‚Ä¢ RHT : ${joursRHT.length} jour(s)<br>
                ‚Ä¢ F√©ri√©s : ${joursFeries.length} jour(s)<br>
                ‚Ä¢ Rattrap√©s : ${joursRattrapes.length} jour(s)<br><br>
                <strong>Derni√®re mise √† jour :</strong> ${new Date().toLocaleString()}
            `;
        }
        
        // Actualiser les donn√©es au chargement
        document.addEventListener('DOMContentLoaded', refreshData);
    </script>
</body>
</html>
